<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìÑ –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä –¢–µ–∫—Å—Ç ‚áÑ JSON</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            padding: 30px;
            text-align: center;
            color: white;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0;
            min-height: 70vh;
        }

        .panel {
            padding: 30px;
            display: flex;
            flex-direction: column;
        }

        .panel-left {
            border-right: 1px solid #e0e6ed;
            background: #f8faff;
        }

        .panel-right {
            background: #f0fdff;
        }

        .panel h2 {
            font-size: 1.5em;
            margin-bottom: 20px;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .file-upload {
            background: rgba(79, 172, 254, 0.1);
            border: 2px dashed #4facfe;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .file-upload:hover {
            background: rgba(79, 172, 254, 0.15);
            border-color: #2980b9;
        }

        .file-upload input {
            display: none;
        }

        .file-upload label {
            cursor: pointer;
            padding: 10px 20px;
            background: #4facfe;
            color: white;
            border-radius: 25px;
            transition: background 0.3s;
            display: inline-block;
        }

        .file-upload label:hover {
            background: #2980b9;
        }

        .file-info {
            margin-top: 10px;
            font-size: 12px;
            color: #666;
        }

        .textarea-container {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        textarea {
            flex: 1;
            border: 2px solid #e0e6ed;
            border-radius: 10px;
            padding: 20px;
            font-size: 14px;
            font-family: 'Consolas', 'Monaco', monospace;
            resize: none;
            transition: border-color 0.3s ease;
            min-height: 400px;
            line-height: 1.5;
        }

        textarea:focus {
            outline: none;
            border-color: #4facfe;
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1);
        }

        .buttons {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-convert {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            box-shadow: 0 4px 15px rgba(79, 172, 254, 0.3);
        }

        .btn-download {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            box-shadow: 0 4px 15px rgba(56, 239, 125, 0.3);
        }

        .btn-clear {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
        }

        .format-help {
            background: #fff;
            border: 2px solid #e0e6ed;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            font-size: 13px;
            color: #666;
        }

        .format-help h3 {
            color: #4facfe;
            margin-bottom: 10px;
        }

        .format-help pre {
            background: #f8faff;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
            white-space: pre-wrap;
        }

        .stats {
            display: flex;
            justify-content: space-between;
            background: rgba(79, 172, 254, 0.1);
            padding: 10px 15px;
            border-radius: 5px;
            margin-top: 10px;
            font-size: 12px;
            color: #666;
        }

        .message {
            padding: 10px;
            border-radius: 5px;
            margin-top: 10px;
            display: none;
        }

        .error {
            background: #fee;
            border: 1px solid #fcc;
            color: #c66;
        }

        .success {
            background: #efe;
            border: 1px solid #cfc;
            color: #6c6;
        }

        .drop-zone {
            border: 2px dashed #ccc;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            text-align: center;
            color: #999;
            transition: all 0.3s ease;
        }

        .drop-zone.dragover {
            border-color: #4facfe;
            background: rgba(79, 172, 254, 0.1);
            color: #4facfe;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .container {
                margin: 10px;
                border-radius: 10px;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .panel {
                padding: 20px;
            }
            
            .panel-left {
                border-right: none;
                border-bottom: 1px solid #e0e6ed;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìÑ –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä –¢–µ–∫—Å—Ç ‚áÑ JSON</h1>
            <p>–ò–º–ø–æ—Ä—Ç —Ñ–∞–π–ª–æ–≤ –∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –º–µ–∂–¥—É —Ç–µ–∫—Å—Ç–æ–º –∏ JSON –¥–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤</p>
        </div>

        <div class="main-content">
            <!-- Left Panel: Text Input -->
            <div class="panel panel-left">
                <h2>üìù –¢–µ–∫—Å—Ç</h2>
                
                <div class="file-upload">
                    <input type="file" id="textFileInput" accept=".txt,.md" />
                    <label for="textFileInput">üìÅ –ò–º–ø–æ—Ä—Ç —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞</label>
                    <div class="file-info">–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è: .txt, .md</div>
                </div>

                <div class="drop-zone" id="textDropZone">
                    üéØ –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª —Å—é–¥–∞
                </div>
                
                <div class="format-help">
                    <h3>–§–æ—Ä–º–∞—Ç —Ç–µ–∫—Å—Ç–∞:</h3>
                    <pre>–®–∞◊ú◊î: –ö–∞–∫–æ–≤–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –≤–∑–ª–µ—Ç–∞?
–û—Ç–≤–µ—Ç: 120 —É–∑–ª–æ–≤
–û–±—ä—è—Å–Ω–µ–Ω–∏–µ: –°–æ–≥–ª–∞—Å–Ω–æ –∞–≤–∏–∞—Ü–∏–æ–Ω–Ω—ã–º –ø—Ä–∞–≤–∏–ª–∞–º...
–ò—Å—Ç–æ—á–Ω–∏–∫: –†–∞–∑–¥–µ–ª 74-76

–í–æ–ø—Ä–æ—Å: –°–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å...
–û—Ç–≤–µ—Ç: –°–ª–µ–¥—É—é—â–∏–π –æ—Ç–≤–µ—Ç...

# –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ:
–í–æ–ø—Ä–æ—Å: –í–æ–ø—Ä–æ—Å –±–µ–∑ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è
–û—Ç–≤–µ—Ç: –û—Ç–≤–µ—Ç</pre>
                </div>

                <div class="textarea-container">
                    <textarea id="textInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –≤–æ–ø—Ä–æ—Å—ã –∏ –æ—Ç–≤–µ—Ç—ã...

–ü—Ä–∏–º–µ—Ä:
–í–æ–ø—Ä–æ—Å: –ö–∞–∫–æ–≤–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –≤–∑–ª–µ—Ç–∞?
–û—Ç–≤–µ—Ç: 120 —É–∑–ª–æ–≤  
–û–±—ä—è—Å–Ω–µ–Ω–∏–µ: –°–æ–≥–ª–∞—Å–Ω–æ –∞–≤–∏–∞—Ü–∏–æ–Ω–Ω—ã–º –ø—Ä–∞–≤–∏–ª–∞–º
–ò—Å—Ç–æ—á–Ω–∏–∫: –†–∞–∑–¥–µ–ª 74-76

–í–æ–ø—Ä–æ—Å: –ö–∞–∫–æ–≤ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —ç—à–µ–ª–æ–Ω –ø–æ–ª–µ—Ç–∞?
–û—Ç–≤–µ—Ç: 500 —Ñ—É—Ç–æ–≤
"></textarea>
                </div>

                <div class="buttons">
                    <button class="btn btn-convert" onclick="convertToJson()">‚û°Ô∏è –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ JSON</button>
                    <button class="btn btn-clear" onclick="clearText()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
                </div>

                <div class="stats">
                    <span id="textStats">0 —Å–∏–º–≤–æ–ª–æ–≤</span>
                    <span id="questionCount">0 –≤–æ–ø—Ä–æ—Å–æ–≤</span>
                </div>

                <div id="textError" class="message error"></div>
                <div id="textSuccess" class="message success"></div>
            </div>

            <!-- Right Panel: JSON Output -->
            <div class="panel panel-right">
                <h2>‚öôÔ∏è JSON</h2>
                
                <div class="file-upload">
                    <input type="file" id="jsonFileInput" accept=".json" />
                    <label for="jsonFileInput">üìÅ –ò–º–ø–æ—Ä—Ç JSON —Ñ–∞–π–ª–∞</label>
                    <div class="file-info">–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è: .json</div>
                </div>

                <div class="drop-zone" id="jsonDropZone">
                    üéØ –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ JSON —Ñ–∞–π–ª —Å—é–¥–∞
                </div>
                
                <div class="format-help">
                    <h3>–§–æ—Ä–º–∞—Ç JSON:</h3>
                    <pre>{
  "questions": [
    {
      "id": 1,
      "question": "–í–æ–ø—Ä–æ—Å...",
      "answer": "–û—Ç–≤–µ—Ç...",
      "explanation": "–û–±—ä—è—Å–Ω–µ–Ω–∏–µ...",
      "source": "–ò—Å—Ç–æ—á–Ω–∏–∫..."
    }
  ]
}</pre>
                </div>

                <div class="textarea-container">
                    <textarea id="jsonOutput" placeholder="–ó–¥–µ—Å—å –ø–æ—è–≤–∏—Ç—Å—è JSON –≥–æ—Ç–æ–≤—ã–π –∫ —Å–∫–∞—á–∏–≤–∞–Ω–∏—é..."></textarea>
                </div>

                <div class="buttons">
                    <button class="btn btn-convert" onclick="convertToText()">‚¨ÖÔ∏è –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ —Ç–µ–∫—Å—Ç</button>
                    <button class="btn btn-download" onclick="downloadJson()">‚¨áÔ∏è –°–∫–∞—á–∞—Ç—å JSON</button>
                    <button class="btn btn-clear" onclick="clearJson()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
                </div>

                <div class="stats">
                    <span id="jsonStats">0 —Å–∏–º–≤–æ–ª–æ–≤</span>
                    <span id="jsonQuestionCount">0 –≤–æ–ø—Ä–æ—Å–æ–≤</span>
                </div>

                <div id="jsonError" class="message error"></div>
                <div id="jsonSuccess" class="message success"></div>
            </div>
        </div>
    </div>

    <script>
        // Elements
        const textInput = document.getElementById('textInput');
        const jsonOutput = document.getElementById('jsonOutput');
        const textFileInput = document.getElementById('textFileInput');
        const jsonFileInput = document.getElementById('jsonFileInput');
        const textDropZone = document.getElementById('textDropZone');
        const jsonDropZone = document.getElementById('jsonDropZone');
        const textStats = document.getElementById('textStats');
        const questionCount = document.getElementById('questionCount');
        const jsonStats = document.getElementById('jsonStats');
        const jsonQuestionCount = document.getElementById('jsonQuestionCount');
        const textError = document.getElementById('textError');
        const textSuccess = document.getElementById('textSuccess');
        const jsonError = document.getElementById('jsonError');
        const jsonSuccess = document.getElementById('jsonSuccess');

        // Event listeners
        textInput.addEventListener('input', updateTextStats);
        jsonOutput.addEventListener('input', updateJsonStats);
        textFileInput.addEventListener('change', handleTextFileImport);
        jsonFileInput.addEventListener('change', handleJsonFileImport);

        // Drag and drop for text files
        textDropZone.addEventListener('dragover', handleDragOver);
        textDropZone.addEventListener('drop', handleTextFileDrop);
        textDropZone.addEventListener('dragleave', handleDragLeave);

        // Drag and drop for JSON files
        jsonDropZone.addEventListener('dragover', handleDragOver);
        jsonDropZone.addEventListener('drop', handleJsonFileDrop);
        jsonDropZone.addEventListener('dragleave', handleDragLeave);

        function handleDragOver(e) {
            e.preventDefault();
            e.target.classList.add('dragover');
        }

        function handleDragLeave(e) {
            e.target.classList.remove('dragover');
        }

        function handleTextFileDrop(e) {
            e.preventDefault();
            e.target.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                const file = files[0];
                if (file.name.endsWith('.txt') || file.name.endsWith('.md')) {
                    readTextFile(file);
                } else {
                    showError(textError, '–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ .txt –∏ .md —Ñ–∞–π–ª—ã');
                }
            }
        }

        function handleJsonFileDrop(e) {
            e.preventDefault();
            e.target.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                const file = files[0];
                if (file.name.endsWith('.json')) {
                    readJsonFile(file);
                } else {
                    showError(jsonError, '–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ .json —Ñ–∞–π–ª—ã');
                }
            }
        }

        function handleTextFileImport(e) {
            const file = e.target.files[0];
            if (file) {
                readTextFile(file);
            }
        }

        function handleJsonFileImport(e) {
            const file = e.target.files[0];
            if (file) {
                readJsonFile(file);
            }
        }

        function readTextFile(file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                textInput.value = e.target.result;
                updateTextStats();
                showSuccess(textSuccess, `–§–∞–π–ª "${file.name}" —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω!`);
            };
            reader.onerror = function() {
                showError(textError, '–û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞');
            };
            reader.readAsText(file, 'UTF-8');
        }

        function readJsonFile(file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const content = e.target.result;
                    // Validate JSON
                    JSON.parse(content);
                    jsonOutput.value = content;
                    updateJsonStats();
                    showSuccess(jsonSuccess, `JSON —Ñ–∞–π–ª "${file.name}" —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω!`);
                } catch (error) {
                    showError(jsonError, `–û—à–∏–±–∫–∞ –≤ JSON —Ñ–∞–π–ª–µ: ${error.message}`);
                }
            };
            reader.onerror = function() {
                showError(jsonError, '–û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞');
            };
            reader.readAsText(file, 'UTF-8');
        }

        function updateTextStats() {
            const text = textInput.value;
            const charCount = text.length;
            const questions = parseTextToQuestions(text);
            
            textStats.textContent = `${charCount} —Å–∏–º–≤–æ–ª–æ–≤`;
            questionCount.textContent = `${questions.length} –≤–æ–ø—Ä–æ—Å–æ–≤`;
        }

        function updateJsonStats() {
            const text = jsonOutput.value;
            const charCount = text.length;
            
            try {
                const json = JSON.parse(text);
                const questions = json.questions || [];
                jsonStats.textContent = `${charCount} —Å–∏–º–≤–æ–ª–æ–≤`;
                jsonQuestionCount.textContent = `${questions.length} –≤–æ–ø—Ä–æ—Å–æ–≤`;
            } catch (e) {
                jsonStats.textContent = `${charCount} —Å–∏–º–≤–æ–ª–æ–≤`;
                jsonQuestionCount.textContent = 'JSON –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π';
            }
        }

        function parseTextToQuestions(text) {
            if (!text.trim()) return [];
            
            const questions = [];
            const blocks = text.split(/\n\s*\n/).filter(block => block.trim());
            
            blocks.forEach((block, index) => {
                const lines = block.trim().split('\n').map(line => line.trim());
                const question = { id: index + 1, question: '', answer: '', explanation: '', source: '' };
                
                lines.forEach(line => {
                    if (line.match(/^(–≤–æ–ø—Ä–æ—Å|◊©◊ê◊ú◊î):/i)) {
                        question.question = line.replace(/^(–≤–æ–ø—Ä–æ—Å|◊©◊ê◊ú◊î):/i, '').trim();
                    } else if (line.match(/^(–æ—Ç–≤–µ—Ç|◊™◊©◊ï◊ë◊î):/i)) {
                        question.answer = line.replace(/^(–æ—Ç–≤–µ—Ç|◊™◊©◊ï◊ë◊î):/i, '').trim();
                    } else if (line.match(/^(–æ–±—ä—è—Å–Ω–µ–Ω–∏–µ|◊î◊°◊ë◊®):/i)) {
                        question.explanation = line.replace(/^(–æ–±—ä—è—Å–Ω–µ–Ω–∏–µ|◊î◊°◊ë◊®):/i, '').trim();
                    } else if (line.match(/^(–∏—Å—Ç–æ—á–Ω–∏–∫|◊û◊ß◊ï◊®):/i)) {
                        question.source = line.replace(/^(–∏—Å—Ç–æ—á–Ω–∏–∫|◊û◊ß◊ï◊®):/i, '').trim();
                    }
                });
                
                if (question.question && question.answer) {
                    questions.push(question);
                }
            });
            
            return questions;
        }

        function convertToJson() {
            hideMessages();
            
            const text = textInput.value.trim();
            if (!text) {
                showError(textError, '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∏–ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Ç–µ–∫—Å—Ç');
                return;
            }

            try {
                const questions = parseTextToQuestions(text);
                
                if (questions.length === 0) {
                    showError(textError, '–ù–µ –Ω–∞–π–¥–µ–Ω–æ –≤–∞–ª–∏–¥–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç.');
                    return;
                }

                const jsonData = {
                    questions: questions
                };

                jsonOutput.value = JSON.stringify(jsonData, null, 2);
                updateJsonStats();
                showSuccess(textSuccess, `–°–æ–∑–¥–∞–Ω–æ ${questions.length} –≤–æ–ø—Ä–æ—Å–æ–≤!`);
            } catch (error) {
                showError(textError, '–û—à–∏–±–∫–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏: ' + error.message);
            }
        }

        function convertToText() {
            hideMessages();
            
            const jsonText = jsonOutput.value.trim();
            if (!jsonText) {
                showError(jsonError, '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∏–ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ JSON');
                return;
            }

            try {
                const data = JSON.parse(jsonText);
                const questions = data.questions || [];
                
                if (!Array.isArray(questions)) {
                    showError(jsonError, '–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç JSON - –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –º–∞—Å—Å–∏–≤ questions');
                    return;
                }

                let textOutput = '';
                questions.forEach(q => {
                    textOutput += `–í–æ–ø—Ä–æ—Å: ${q.question || ''}\n`;
                    textOutput += `–û—Ç–≤–µ—Ç: ${q.answer || ''}\n`;
                    if (q.explanation) {
                        textOutput += `–û–±—ä—è—Å–Ω–µ–Ω–∏–µ: ${q.explanation}\n`;
                    }
                    if (q.source) {
                        textOutput += `–ò—Å—Ç–æ—á–Ω–∏–∫: ${q.source}\n`;
                    }
                    textOutput += '\n';
                });

                textInput.value = textOutput.trim();
                updateTextStats();
                showSuccess(jsonSuccess, `–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ ${questions.length} –≤–æ–ø—Ä–æ—Å–æ–≤!`);
            } catch (error) {
                showError(jsonError, '–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON: ' + error.message);
            }
        }

        function downloadJson() {
            const jsonText = jsonOutput.value.trim();
            if (!jsonText) {
                showError(jsonError, '–ù–µ—á–µ–≥–æ —Å–∫–∞—á–∏–≤–∞—Ç—å');
                return;
            }

            try {
                // Validate JSON first
                JSON.parse(jsonText);
                
                const blob = new Blob([jsonText], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'questions.json';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                showSuccess(jsonSuccess, '–§–∞–π–ª questions.json —Å–∫–∞—á–∞–Ω!');
            } catch (error) {
                showError(jsonError, '–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–∫–∞—á–∞—Ç—å - –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π JSON');
            }
        }

        function clearText() {
            textInput.value = '';
            updateTextStats();
            hideMessages();
        }

        function clearJson() {
            jsonOutput.value = '';
            updateJsonStats();
            hideMessages();
        }

        function showError(element, message) {
            element.textContent = message;
            element.style.display = 'block';
            setTimeout(() => {
                element.style.display = 'none';
            }, 5000);
        }

        function showSuccess(element, message) {
            element.textContent = message;
            element.style.display = 'block';
            setTimeout(() => {
                element.style.display = 'none';
            }, 3000);
        }

        function hideMessages() {
            textError.style.display = 'none';
            textSuccess.style.display = 'none';
            jsonError.style.display = 'none';
            jsonSuccess.style.display = 'none';
        }

        // Initialize stats
        updateTextStats();
        updateJsonStats();
    </script>
</body>
</html>
